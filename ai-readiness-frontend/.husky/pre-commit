#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit security validation..."

# Run security scan first (fastest check)
echo "ğŸ›¡ï¸  Security scan..."
npm run test:security || {
  echo "âŒ Security scan failed! Commit blocked."
  exit 1
}

# Run linting (fast check)
echo "ğŸ§¹ Linting..."
npm run lint || {
  echo "âŒ Linting failed! Please fix linting errors."
  exit 1
}

# Run type checking (medium speed check)
echo "ğŸ” Type checking..."
npm run type-check || {
  echo "âŒ Type checking failed! Please fix TypeScript errors."
  exit 1
}

# Run fast tests (security tests only)
echo "ğŸ§ª Running security tests..."
npm run test:security-tests || {
  echo "âŒ Security tests failed! Commit blocked."
  exit 1
}

echo "âœ… All pre-commit checks passed!"